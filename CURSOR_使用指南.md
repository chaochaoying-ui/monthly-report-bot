# Cursor 使用指南 - 月报机器人项目

本项目已自动配置完成，以下是快速上手指南。

## ✅ 已自动配置的内容

### 1. 项目级AI规则 (`.cursorrules`)
- 定义了项目特定的代码规范
- 飞书机器人开发最佳实践
- 错误处理和日志规范
- 测试要求

### 2. 工作区设置 (`.vscode/settings.json`)
- Python开发环境配置
- Black代码格式化（120字符行长度）
- 保存时自动格式化
- UTF-8编码
- 自动保存功能

### 3. 推荐扩展 (`.vscode/extensions.json`)
- Python开发工具
- 代码质量检查
- 版本控制增强

## 🚀 快速开始

### 常用快捷键（已优化）

| 快捷键 | 功能 | 说明 |
|--------|------|------|
| `Ctrl+L` | AI聊天 | 打开AI助手，描述需求即可自动编程 |
| `Ctrl+K` | 行内编辑 | 选中代码后快速修改 |
| `Ctrl+Shift+L` | 新建聊天 | 开始新的对话会话 |
| `Tab` | 接受建议 | 接受AI的代码补全 |
| `Ctrl+→` | 部分接受 | 按词接受AI建议 |
| `Ctrl+.` | 快速修复 | 自动修复错误 |
| `Ctrl+D` | 多选 | 选中下一个相同词 |
| `Alt+Click` | 多光标 | 在多处同时编辑 |

### AI助手使用技巧

#### 1. 引用代码
```
@filename.py - 引用特定文件
@foldername/ - 引用整个目录
@Code - 引用当前选中的代码
@Web - 搜索网络信息
```

#### 2. 最佳对话方式
**✅ 推荐：**
- "帮我在 monthly_report_bot_final_interactive.py 中添加任务导出功能"
- "修复 @task_stats_manager.py 中的日期格式问题"
- "为 tests/ 目录下的测试添加飞书API mock"

**❌ 不推荐：**
- "改一下代码" （太模糊）
- "这个有bug" （没有说明具体文件和问题）

#### 3. 项目特定命令示例
```
"为新功能创建测试用例"
"重构消息处理函数，提高代码可读性"
"添加任务统计图表生成功能"
"优化WebSocket重连逻辑"
"检查所有飞书API调用的错误处理"
```

## 📝 项目特定规则

### 代码风格
- ✅ 中文注释
- ✅ 类型注解（所有函数）
- ✅ 行长度120字符
- ✅ 使用logging，禁用print

### 飞书开发注意事项
- ⚠️ 卡片@标签格式：`<at id="用户ID">显示名称</at>`
- ⚠️ 必须检查消息是否@机器人
- ⚠️ WebSocket需要心跳检测
- ⚠️ 所有API调用需要异常处理

### 文件组织
```
app/                    # 核心应用代码
scripts/                # 工具脚本
tests/                  # 测试文件
docs/                   # 文档
tasks.yaml              # 任务定义
task_stats.json         # 统计数据
requirements_v1_1.txt   # 依赖列表
```

## 🔧 常见场景

### 场景1：添加新功能
1. 按 `Ctrl+L` 打开AI聊天
2. 描述功能需求，例如：
   ```
   "添加任务优先级功能，支持高中低三个级别，
   在tasks.yaml中添加priority字段，
   在卡片显示中用不同颜色标识"
   ```
3. AI会自动：
   - 修改相关文件
   - 添加测试用例
   - 更新文档

### 场景2：修复Bug
1. 选中有问题的代码
2. 按 `Ctrl+K`
3. 描述问题，例如："修复任务完成时间格式显示错误"

### 场景3：代码重构
1. 按 `Ctrl+L`
2. 说明重构目标，例如：
   ```
   "重构 @monthly_report_bot_final_interactive.py 中的
   消息处理逻辑，将不同类型的消息分离到独立函数中"
   ```

### 场景4：生成测试
```
"为 smart_interaction_ws_v1_1.py 的智能任务完成功能
生成完整的单元测试，覆盖所有关键词和边界情况"
```

## ⚙️ 自定义配置

### 调整AI响应速度
```
Settings → Cursor Settings → Features
- Suggestion delay: 100-500ms（默认200ms）
```

### 隐私模式（企业推荐）
```
Settings → Cursor Settings → Privacy
- ✅ Privacy Mode（代码不上传服务器）
- ✅ 仅索引本地代码
```

### 选择AI模型
```
Settings → Cursor Settings → Models
- 默认：Claude Sonnet 4.5（最强）
- 快速：GPT-4（响应更快）
```

## 🌐 中国网络优化

如遇连接问题：
```
Settings → Proxy
- HTTP Proxy: http://127.0.0.1:7890（根据实际情况）
- HTTPS Proxy: http://127.0.0.1:7890
```

## 💡 高级技巧

### 1. 批量操作
选中多个相同内容（Ctrl+D），一次性修改

### 2. 代码片段
使用AI生成常用代码模板，保存为snippet

### 3. 任务管理
复杂任务AI会自动创建TODO列表跟踪进度

### 4. 上下文管理
聊天中使用 `@` 精确控制AI的上下文范围

## 📚 学习资源

- Cursor官方文档: https://docs.cursor.com
- 快捷键速查: 按 `Ctrl+K Ctrl+S`
- 命令面板: `Ctrl+Shift+P`

## 🎯 项目特定快速命令

在AI聊天中可以直接说：
- "启动机器人" → 解释如何运行
- "查看任务列表" → 显示tasks.yaml内容
- "检查配置" → 验证环境变量
- "生成月报" → 创建统计报告
- "添加测试" → 为功能生成测试

---

**提示：** 所有配置已自动完成，重启Cursor即可生效。开始编程时直接按 `Ctrl+L` 描述需求即可！



