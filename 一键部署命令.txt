================================================================================
从 GitHub 部署修复到 GCP - 一键命令
================================================================================

✅ 修复已推送到 GitHub
✅ 仓库: https://github.com/chaochaoying-ui/monthly-report-bot
✅ 提交: b9fc048

================================================================================
部署步骤
================================================================================

1️⃣ 打开 GCP 控制台
   https://console.cloud.google.com/

2️⃣ 找到 VM 实例 "monthly-report-bot"
   点击右侧的 "SSH" 按钮

3️⃣ 在打开的终端中，复制粘贴以下全部命令（一次性），按回车执行：

================================================================================
↓↓↓ 复制下面所有内容 ↓↓↓
================================================================================

cd ~/monthly-report-bot && \
echo "=== 备份当前代码 ===" && \
mkdir -p ~/monthly-report-bot-backups && \
cp -r monthly_report_bot_link_pack ~/monthly-report-bot-backups/monthly_report_bot_link_pack.$(date +%Y%m%d_%H%M%S) && \
echo "=== 拉取最新代码 ===" && \
git pull origin main && \
echo "=== 验证修复 ===" && \
cd monthly_report_bot_link_pack && \
grep -c "display_name = get_user_display_name" monthly_report_bot_final_interactive.py && \
echo "=== 重启服务 ===" && \
sudo systemctl restart monthly-report-bot && \
sleep 3 && \
sudo systemctl status monthly-report-bot --no-pager | head -10 && \
echo "" && \
echo "=== 测试每日提醒 ===" && \
source venv/bin/activate && \
python3 -c "import asyncio; from monthly_report_bot_final_interactive import test_daily_reminder; asyncio.run(test_daily_reminder())" && \
echo "" && \
echo "✅✅✅ 部署完成！请检查飞书群消息 ✅✅✅"

================================================================================
↑↑↑ 复制上面所有内容 ↑↑↑
================================================================================

4️⃣ 验证结果

看到输出：
  ✅ 找到 3 处修复
  ✅ 服务运行中
  ✅ 每日提醒测试成功

检查飞书群：
  ✅ 收到每日提醒消息
  ✅ 负责人 @ 显示姓名（如: @周超, @张三）
  ✅ 点击 @ 可以跳转

================================================================================
完成！🎉
================================================================================

如有问题，查看详细文档: GCP_DEPLOY_FROM_GITHUB.md
