# 月报机器人开机自启动设置说明

## 🚀 三种设置方法

### 方法1：启动文件夹方式（推荐）
**最简单，适合普通用户**

1. 双击运行 `setup_startup_folder.bat`
2. 脚本会自动将启动文件复制到Windows启动文件夹
3. 重启计算机即可自动启动

**优点：**
- 设置简单，一键完成
- 易于管理和删除
- 不需要管理员权限

**管理方法：**
- 按 `Win+R`，输入 `shell:startup`
- 可以找到"月报机器人启动.bat"文件
- 删除该文件即可取消开机自启动

---

### 方法2：任务计划程序方式
**功能强大，适合高级用户**

1. 右键点击 `setup_auto_start.bat`，选择"以管理员身份运行"
2. 脚本会自动创建任务计划程序任务
3. 重启计算机即可自动启动

**优点：**
- 可以设置延迟启动
- 可以设置触发条件
- 系统级管理

**管理方法：**
- 按 `Win+R`，输入 `taskschd.msc`
- 找到"月报机器人自启动"任务
- 可以修改、删除或立即运行

---

### 方法3：Windows服务方式
**最稳定，适合服务器环境**

1. 右键点击 `install_service.bat`，选择"以管理员身份运行"
2. 脚本会自动安装Windows服务
3. 重启计算机即可自动启动

**优点：**
- 系统级服务，最稳定
- 可以设置服务依赖
- 支持服务恢复

**管理方法：**
- 按 `Win+R`，输入 `services.msc`
- 找到"月报机器人服务"
- 可以启动、停止、重启服务

---

## 🔧 服务管理命令

### 任务计划程序管理
```cmd
# 查看任务
schtasks /query /tn "月报机器人自启动"

# 立即运行任务
schtasks /run /tn "月报机器人自启动"

# 删除任务
schtasks /delete /tn "月报机器人自启动" /f
```

### Windows服务管理
```cmd
# 启动服务
sc start MonthlyReportBot

# 停止服务
sc stop MonthlyReportBot

# 查看服务状态
sc query MonthlyReportBot

# 删除服务
sc delete MonthlyReportBot
```

---

## 📋 设置前准备

1. **确保程序正常运行**
   - 先手动运行 `start_bot.bat` 测试
   - 确认机器人能正常启动和连接

2. **检查环境变量**
   - 确认 `set_environment.bat` 中的配置正确
   - 特别是 `CHAT_ID` 等关键参数

3. **备份重要文件**
   - 备份 `monthly_report_bot_final_interactive.py`
   - 备份 `set_environment.bat`

---

## ⚠️ 注意事项

1. **权限要求**
   - 方法2和方法3需要管理员权限
   - 方法1不需要管理员权限

2. **防火墙设置**
   - 确保Python程序可以访问网络
   - 可能需要允许Python通过防火墙

3. **杀毒软件**
   - 某些杀毒软件可能阻止自启动
   - 需要将程序添加到白名单

4. **系统资源**
   - 机器人会持续运行，占用一定内存
   - 建议定期检查系统资源使用情况

---

## 🐛 故障排除

### 程序无法自启动
1. 检查启动脚本是否存在
2. 检查环境变量是否正确设置
3. 查看Windows事件日志
4. 手动运行脚本测试

### 程序启动后立即退出
1. 检查Python环境是否正确
2. 检查依赖包是否安装完整
3. 查看程序日志文件
4. 检查网络连接

### 服务无法启动
1. 检查服务配置是否正确
2. 检查Python路径是否正确
3. 查看系统事件日志
4. 尝试手动启动服务

---

## 📞 技术支持

如果遇到问题，请提供以下信息：
1. Windows版本
2. Python版本
3. 错误日志
4. 使用的设置方法
5. 具体的错误信息

